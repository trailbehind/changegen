<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Quickstart / Usage Guide" href="quickstart.html" />

    <meta name="generator" content="sphinx-4.1.2, furo 2021.08.31"/>
        <title>changegen documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=c7c65a82b42f6b978e58466c1e9ef2509836d916" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     These docs are undergoing active development and may change. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">changegen  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="#">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/cglogo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart / Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="postgis.html">PostGIS Tips + Considerations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="source/changegen.html">changegen package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.changewriter.html">Writing OSMChange Files (<code class="docutils literal notranslate"><span class="pre">changewriter</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.db.html">Working with a PostGIS Database (<code class="docutils literal notranslate"><span class="pre">db</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.generator.html"><code class="docutils literal notranslate"><span class="pre">changegen.generator</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.util.html"><code class="docutils literal notranslate"><span class="pre">changegen.util</span></code> Module</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <article role="main">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <section id="changegen-osm-changefiles-from-postgis-tables">
<h1><code class="docutils literal notranslate"><span class="pre">changegen</span></code>: <a class="reference external" href="https://wiki.openstreetmap.org/wiki/OsmChange">OSM Changefiles</a> from PostGIS Tables<a class="headerlink" href="#changegen-osm-changefiles-from-postgis-tables" title="Permalink to this headline">¶</a></h1>
<p>Many workflows based on OpenStreetMap data use PostGIS to enable spatial operations on these data at planetary scale. Expressing modifications, additions, or deletions to these data is sometimes necessary: for example, to communicate those changes to another system or workflow without access to the PostGIS instance.</p>
<p><code class="docutils literal notranslate"><span class="pre">changegen</span></code> is a command line utilty that creates (optionally gzipped) <a class="reference external" href="https://wiki.openstreetmap.org/wiki/OsmChange">OSM Changefiles</a> from PostGIS tables. Changefiles can then be applied to existing OSM extracts to create new extracts containing the modifications described in the changefile.</p>
<section id="things-changegen-can-do">
<h2>Things <code class="docutils literal notranslate"><span class="pre">changegen</span></code> can do:<a class="headerlink" href="#things-changegen-can-do" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Translate from PostGIS <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code> to OpenStreetMap XML formats (<code class="docutils literal notranslate"><span class="pre">Ways</span></code>, <code class="docutils literal notranslate"><span class="pre">Nodes</span></code>). (<strong>NB</strong>: Only <code class="docutils literal notranslate"><span class="pre">Polygon</span></code>, <code class="docutils literal notranslate"><span class="pre">Point</span></code> and <code class="docutils literal notranslate"><span class="pre">LineString</span></code> data types are currently supported).</p></li>
<li><p><strong>Create</strong> new <code class="docutils literal notranslate"><span class="pre">Polygons</span></code> (e.g. closed <code class="docutils literal notranslate"><span class="pre">Ways</span></code> or <code class="docutils literal notranslate"><span class="pre">Relations</span></code>) or <code class="docutils literal notranslate"><span class="pre">LineStrings</span></code> (<code class="docutils literal notranslate"><span class="pre">Ways</span></code> and <code class="docutils literal notranslate"><span class="pre">Nodes</span></code>) from objects in PostGIS tables, with corresponding schema as OSM tags</p></li>
<li><p><strong>Ensure</strong> that new Ways are properly “network-noded” : e.g. that they share nodes at intersections with both <em>existing</em> and <em>new</em> geometries. This is important for e.g. ensuring accurate network topology. This also includes modifying <em>existing</em> <code class="docutils literal notranslate"><span class="pre">Ways</span></code> to include these noded intersections. (<strong>NB</strong>: Intersections with <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> objects is not currently supported.)</p></li>
<li><p><strong>Modify</strong> the metadata of <code class="docutils literal notranslate"><span class="pre">Ways</span></code> in an existing OSM extract.</p></li>
<li><p><strong>Delete</strong> any OSM object specified by an <code class="docutils literal notranslate"><span class="pre">osm_id</span></code> column in a PostGIS table.</p></li>
</ul>
</section>
<section id="example-usage-scenario">
<h2>Example Usage Scenario<a class="headerlink" href="#example-usage-scenario" title="Permalink to this headline">¶</a></h2>
<p>In some workflows, it is common to want to modify the data in an OSM Planet file programmatically. For example, to standardize the set of tags for a given class of OSM objects, or to used third-party data to modify OSM objects regionally. PostGIS is a compelling tool for this kind of processing, as it scales well to large datasets and has fast and flexible spatial operations. In many cases, however, it is desirable to have an OSM Planet file as the result of this geoprocessing, rather than a set of PostGIS tables.</p>
<p>This is why we developed <code class="docutils literal notranslate"><span class="pre">changegen</span></code>. This tool enables the creation of OSM Changefiles that describe modifications to an existing source OSM Planet file. These modifications are sourced from PostGIS tables, developed using a tool like <a class="reference external" href="https://imposm.org/docs/imposm3/latest/">imposm</a> and custom SQL. <code class="docutils literal notranslate"><span class="pre">Changegen</span></code> takes care of making sure that intersections are properly noded, that PostGIS geospatial types are converted accurately to OSM types, managing OSM IDs for new and modified objects. At the end of the workflow, the changefile that’s produced by Changegen (derived from the original OSM file and the PostGIS database tables specified), can be applied to the original planet file (using a tool like <a class="reference external" href="https://wiki.openstreetmap.org/wiki/Osmosis">osmosis</a> ), to obtain an OSM Planet file that contains the modifications performed via the PostGIS database.</p>
<img alt="_images/changegen-schematic.png" src="_images/changegen-schematic.png"/>
<center><i>Schematic of example usage</i></center></section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">changegen</span></code> is not available on <code class="docutils literal notranslate"><span class="pre">pip</span></code> but is <code class="docutils literal notranslate"><span class="pre">pip</span></code> -installable:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/trailbehind/changegen.git
pip install -e changegen
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">changegen</span></code> depends on: <code class="docutils literal notranslate"><span class="pre">click</span></code>, <code class="docutils literal notranslate"><span class="pre">tqdm</span></code>, <code class="docutils literal notranslate"><span class="pre">osmium</span></code>, <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, <code class="docutils literal notranslate"><span class="pre">gdal</span></code>, <code class="docutils literal notranslate"><span class="pre">lxml</span></code>, <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code>, <code class="docutils literal notranslate"><span class="pre">pyproj</span></code>, and <code class="docutils literal notranslate"><span class="pre">rtree</span></code>.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart / Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#setup-installation">Setup + Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#using-the-changegen-cli">Using the Changegen CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#other-features">Other Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postgis.html">PostGIS Tips + Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/changegen.html">changegen package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.html#module-changegen">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="quickstart.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Quickstart / Usage Guide</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>

        <div class="related-information">
            |
            <a class="muted-link" href="_sources/index.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">changegen</span></code>: OSM Changefiles from PostGIS Tables</a><ul>
<li><a class="reference internal" href="#things-changegen-can-do">Things <code class="docutils literal notranslate"><span class="pre">changegen</span></code> can do:</a></li>
<li><a class="reference internal" href="#example-usage-scenario">Example Usage Scenario</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>