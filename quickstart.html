<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="PostGIS Tips + Considerations" href="postgis.html" /><link rel="prev" title="changegen: OSM Changefiles from PostGIS Tables" href="index.html" />

    <meta name="generator" content="sphinx-4.1.2, furo 2021.08.31"/>
        <title>Quickstart / Usage Guide - changegen documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=c7c65a82b42f6b978e58466c1e9ef2509836d916" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     These docs are undergoing active development and may change. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">changegen  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/cglogo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Quickstart / Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="postgis.html">PostGIS Tips + Considerations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="source/changegen.html">changegen package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.changewriter.html">Writing OSMChange Files (<code class="docutils literal notranslate"><span class="pre">changewriter</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.db.html">Working with a PostGIS Database (<code class="docutils literal notranslate"><span class="pre">db</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.generator.html"><code class="docutils literal notranslate"><span class="pre">changegen.generator</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="source/changegen.util.html"><code class="docutils literal notranslate"><span class="pre">changegen.util</span></code> Module</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <article role="main">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <section id="quickstart-usage-guide">
<h1>Quickstart / Usage Guide<a class="headerlink" href="#quickstart-usage-guide" title="Permalink to this headline">¶</a></h1>
<p>This guide gives a high-level overview of the command line interface to <code class="docutils literal notranslate"><span class="pre">changegen</span></code>. It assumes a fairly technical level of knowledge of PostGIS, OSM file formats, and <a class="reference external" href="https://wiki.openstreetmap.org/wiki/Osmosis">osmosis</a>.</p>
<section id="setup-installation">
<h2>Setup + Installation<a class="headerlink" href="#setup-installation" title="Permalink to this headline">¶</a></h2>
<p>Installing <code class="docutils literal notranslate"><span class="pre">changegen</span></code> is easy with pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">trailbehind</span><span class="o">/</span><span class="n">changegen</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>(you can specify a specific <a class="reference external" href="https://www.github.com/trailbehind/changegen/releases">release</a> with <code class="docutils literal notranslate"><span class="pre">...changegen.git@&lt;release&gt;</span></code>)</p>
<p>This tutorial also assumes the following (since these assumptions fairly accurately describe most use-cases for <code class="docutils literal notranslate"><span class="pre">changegen</span></code>):</p>
<ul class="simple">
<li><p>you have a PostGIS database running on your local computer, or accessible via a network.</p></li>
<li><p>you have an OSM extract</p></li>
<li><p>you have <a class="reference external" href="https://wiki.openstreetmap.org/wiki/Osmosis">osmosis</a> installed</p></li>
<li><p>you have <a class="reference external" href="https://imposm.org/docs/imposm3/latest/">imposm3</a> installed</p></li>
</ul>
<section id="database-setup-access">
<h3>Database Setup + Access<a class="headerlink" href="#database-setup-access" title="Permalink to this headline">¶</a></h3>
<p>To be sure that the PostGIS database used to support changegen operations is setup well, refer to <a class="reference internal" href="postgis.html"><span class="doc">PostGIS Tips + Considerations</span></a> for details.</p>
<p>After the database is setup, we need to provide <code class="docutils literal notranslate"><span class="pre">changegen</span></code> with details on how to connect to this database. By default, <code class="docutils literal notranslate"><span class="pre">changegen</span></code> attempts to connect to a PostGIS database using the following parameters:</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 27%"/>
<col style="width: 35%"/>
<col style="width: 38%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Parameter</strong></p></td>
<td><p><strong>Default Value</strong></p></td>
<td><p><strong>Environment Var</strong></p></td>
</tr>
<tr class="row-even"><td><p>DB Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">conflate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PGDATABASE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Port</p></td>
<td><p>15432</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PGPORT</span></code></p></td>
</tr>
<tr class="row-even"><td><p>User</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">postgres</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PGUSER</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Password</p></td>
<td><p>no password</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PGPASS</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Host</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">localhost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PGHOST</span></code></p></td>
</tr>
</tbody>
</table></div>
<p>To provide alternate access credentials, you may either provide them explicitly on the command line or by setting environment variables, as above. See <code class="docutils literal notranslate"><span class="pre">changegen</span> <span class="pre">--help</span></code> for details on how to provide credentials on the command line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples of CLI use assume that there’s a PostGIS database running on the same system, using the default connection parameters listed above.</p>
</div>
</section>
</section>
<section id="using-the-changegen-cli">
<h2>Using the Changegen CLI<a class="headerlink" href="#using-the-changegen-cli" title="Permalink to this headline">¶</a></h2>
<p>There are several scenarios that are common when using <code class="docutils literal notranslate"><span class="pre">changegen</span></code>, so we’ll cover those explicitly here.</p>
<section id="adding-new-features-to-osm-file">
<h3>Adding new features to OSM file<a class="headerlink" href="#adding-new-features-to-osm-file" title="Permalink to this headline">¶</a></h3>
<p>Commonly we want to add new features to the OSM Planet file, perhaps to augment the OSM database with additional or proprietary information. To do this, it is required that we define a <strong>PostGIS table that contains exclusively features to be added to the OSM file.</strong> For this example we’ll call this table <code class="docutils literal notranslate"><span class="pre">new_features</span></code>.</p>
<p>The following CLI invocation will create a OSM Changefile containing the features in <code class="docutils literal notranslate"><span class="pre">new_features</span></code>. This process does the following:</p>
<ul class="simple">
<li><p>Converts the PostGIS/OGR geometry representation in to OSM Nodes and Ways, as needed</p></li>
<li><p>Converts all fields in the <code class="docutils literal notranslate"><span class="pre">new_features</span></code> table inth OSM Tags to be added to each new Node/Way</p></li>
<li><p>Assigns OSM ID numbers to each new feature to be added to the file.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">changegen</span> <span class="o">--</span><span class="n">suffix</span> <span class="n">new_features</span> <span class="o">-</span><span class="n">outdir</span> <span class="o">.</span> <span class="o">--</span><span class="n">osmsrc</span> <span class="n">data</span><span class="o">.</span><span class="n">osm</span><span class="o">.</span><span class="n">pbf</span>
</pre></div>
</div>
<p>Running this command will create a changefile named <code class="docutils literal notranslate"><span class="pre">new_features.osc</span></code> in the current working directory. <code class="docutils literal notranslate"><span class="pre">data.osm.pbf</span></code> is the path for the source OSM data file that this changefile will eventually be applied to.</p>
<p>This simple invocation works, but could potentially produce an incomplete or otherwise buggy OSM Planet file, because it does not take advantage of many of the features that <code class="docutils literal notranslate"><span class="pre">changegen</span></code> has to offer to prevent many common pitfalls. We’ll demonstrate some modifications to this command that can fix some of these common issues.</p>
<p><strong>Creating properly noded self-intersections</strong></p>
<p>If <code class="docutils literal notranslate"><span class="pre">new_features</span></code> is a set of linestrings that potentially may intersect with each other, and we want these linestrings to have properly noded intersections (see <a class="reference external" href="https://wiki.openstreetmap.org/wiki/Editing_Standards_and_Conventions#Junctions">OSMWiki:Conventions#Junctions</a> for context), we can provide the <code class="docutils literal notranslate"><span class="pre">-si/--self</span></code> flag as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">changegen</span> <span class="o">--</span><span class="n">suffix</span> <span class="n">new_features</span> <span class="o">--</span><span class="bp">self</span> <span class="o">-</span><span class="n">outdir</span> <span class="o">.</span> <span class="o">--</span><span class="n">osmsrc</span> <span class="n">data</span><span class="o">.</span><span class="n">osm</span><span class="o">.</span><span class="n">pbf</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is very important that the source PostGIS table (in this case <code class="docutils literal notranslate"><span class="pre">new_features</span></code>) has a GIST Geometry index defined on its geometry column before using the <code class="docutils literal notranslate"><span class="pre">--self</span></code> flag. If not, this command will take many orders of magnitude longer to execute.</p>
</div>
<p><strong>Creating properly noded intersections with other OSM objects</strong></p>
<p>If <code class="docutils literal notranslate"><span class="pre">new_features</span></code> is a set of linestrings that potentially may intersect with <strong>other OSM objects</strong>, we take a slightly different approach. First, we need to be sure we have an <code class="docutils literal notranslate"><span class="pre">imposm</span></code>-derived PostGIS table that contains any of the geometries that may intersect with any of the features in <code class="docutils literal notranslate"><span class="pre">new_features</span></code>. It’s important that <strong>this table also have a GIST geometry index</strong>.</p>
<p>For this example, let’s assume we have <code class="docutils literal notranslate"><span class="pre">new_features</span></code> and another table of existing OSM objects known as <code class="docutils literal notranslate"><span class="pre">existing_features</span></code>. We can ensure that all intersections between features in <code class="docutils literal notranslate"><span class="pre">new_features</span></code> and features in <code class="docutils literal notranslate"><span class="pre">existing_features</span></code> have proper junction nodes by using the <code class="docutils literal notranslate"><span class="pre">-e/--existing</span></code> flag, e.g. the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>changegen --suffix new_features --self --existing existing_features -outdir . --osmsrc data.osm.pbf
</pre></div>
</div>
<p><strong>Using an OSM ID offset</strong></p>
<p>When adding new features to an OSM planet file, it is important that those new features are assigned IDs that do not collide with existing features in the planet file. Changegen provides support for this by providing an <code class="docutils literal notranslate"><span class="pre">--id_offset</span></code> flag. Passing this flag and an integer value (e.g. <code class="docutils literal notranslate"><span class="pre">--id_offset</span> <span class="pre">500</span></code>) will assign OSM ID values to new features starting with the value 500. It is up to the user to provide an ID offset that will not collide with existing features. If <code class="docutils literal notranslate"><span class="pre">osmium</span></code> is installed, the <code class="docutils literal notranslate"><span class="pre">--no_collisions</span></code> flag will stop execution if any IDs will be assigned to a new feature that would collide with an existing ID.</p>
</section>
<section id="modifying-existing-features-in-the-osm-file">
<h3>Modifying existing features in the OSM file<a class="headerlink" href="#modifying-existing-features-in-the-osm-file" title="Permalink to this headline">¶</a></h3>
<p>Changegen also supports modifying the <strong>metadata</strong> of existing OSM features. <strong>Note</strong> that this feature explicitly does not support modifying geometries. (The case of modifying geometries is supported by a combination of adding and removing features.)</p>
<p>Changegen supports metadata modification via the <code class="docutils literal notranslate"><span class="pre">--modify_meta</span></code> flag. If this flag is provided, any tables that are selected via the <code class="docutils literal notranslate"><span class="pre">--suffix</span></code> flag will be treated as tables that contain existing OSM features to be modified. The resulting changefile will contain <code class="docutils literal notranslate"><span class="pre">&lt;modify&gt;</span></code> tags for each of these features. The Tags for each of these features will mirror the database fields present in the tables (and, optionally, any <code class="docutils literal notranslate"><span class="pre">hstore</span></code> columns – see <a class="reference internal" href="#maintaining-all-tags-with-hstore-columns">Maintaining all Tags with Hstore columns</a> below), and the geometries will be identical to their original representation in the OSM planet file from which they were imported. This method explicitly maintains node order for Ways, and ensures that all modified Ways contain the exact same node references as their original objects (e.g. to maintain original routable junctions in the OSM file).</p>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">modified_features</span></code> is a table of existing OSM features whose metadata have been modified, we can create a changefile expressing these modifications to these existing features like so:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>changegen --suffix modified_features --modify_meta -outdir . --osmsrc data.osm.pbf
</pre></div>
</div>
</section>
<section id="removing-existing-features-in-the-osm-file">
<h3>Removing existing features in the OSM file<a class="headerlink" href="#removing-existing-features-in-the-osm-file" title="Permalink to this headline">¶</a></h3>
<p>The third mode that changegen provides is a deletion mode. This mode can be used in conjunction with either the creation (e.g. the default mode) or the metadata modification mode. To delete OSM features (e.g. if they are being replaced with new features), create a table of the original OSM IDs of these objects to be deleted. This table must contain a column named <code class="docutils literal notranslate"><span class="pre">osm_id</span></code>. Provide the name of this table to <code class="docutils literal notranslate"><span class="pre">changegen</span></code> using the <code class="docutils literal notranslate"><span class="pre">--deletions</span></code> flag, e.g. <code class="docutils literal notranslate"><span class="pre">--deletions</span> <span class="pre">table_of_objects_to_delete</span></code>. Any ID listed in this table will be represented by a <cite>&lt;delete&gt;</cite> node in the resulting changefile. The <code class="docutils literal notranslate"><span class="pre">--deletions</span></code> flag can be provided multiple times.</p>
</section>
</section>
<section id="other-features">
<h2>Other Features<a class="headerlink" href="#other-features" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Changegen</span></code> provides a few more features that can help to support common use-cases of this tool.</p>
<section id="maintaining-all-tags-with-hstore-columns">
<h3>Maintaining all Tags with Hstore columns<a class="headerlink" href="#maintaining-all-tags-with-hstore-columns" title="Permalink to this headline">¶</a></h3>
<p>Most often, <code class="docutils literal notranslate"><span class="pre">changegen</span></code> is used in conjunction with a set of PostGIS tables that have been at least in part created by <code class="docutils literal notranslate"><span class="pre">imposm</span></code>. In many pipelines that involve <code class="docutils literal notranslate"><span class="pre">changegen</span></code>, especially (but not exclusively) those that modify existing features, a certain subset of OSM feature tags are imported using the <code class="docutils literal notranslate"><span class="pre">imposm</span></code> mapping YAML files. These tags (represented in the database as columns) are then used to complete whatever conflation needs to happen.</p>
<p>Often, however, these features contain many other tags that aren’t explicitly imported into the database via imposm. This is relevant to data processing steps after <code class="docutils literal notranslate"><span class="pre">changegen</span></code>. By default, <code class="docutils literal notranslate"><span class="pre">changegen</span></code> only writes as OSM tags database columns that are present in the source table. For example, when modifying an existing OSM feature, if the database table containing the modified feature only contains <code class="docutils literal notranslate"><span class="pre">name</span></code> an <code class="docutils literal notranslate"><span class="pre">highway</span></code> columns, the resulting changefile will only contain <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">highway</span></code> tags, which means that those features will only contain those tags in the OSM Planet file resulting from applying that changefile to another OSM planet file.</p>
<p>This is usually not desirable, because we sometimes can’t know what tags will be necessary for later processing steps. Both <code class="docutils literal notranslate"><span class="pre">imposm</span></code> and <code class="docutils literal notranslate"><span class="pre">changegen</span></code> offer support for this situation. You can use the <code class="docutils literal notranslate"><span class="pre">hstore_tags</span></code> option in imposm (<a class="reference external" href="https://imposm.org/docs/imposm3/latest/mapping.html#hstore-tags">docs</a>) to add a column in the database that contains an hstore object with all tags. By default the only tags included in the hstore are ones that have been explicitly mentioned in the mapping.yaml file. To import all tags known for a feature, you’ll need to use the <code class="docutils literal notranslate"><span class="pre">load_all</span></code> directive (<a class="reference external" href="https://imposm.org/docs/imposm3/latest/mapping.html#tags">docs</a>).</p>
<p>Once you’ve imported all tags, you can specify that <code class="docutils literal notranslate"><span class="pre">changegen</span></code> looks for an hstore column and writes all key:value pairs in the hstore column as Tag objects on every feature. Use the <code class="docutils literal notranslate"><span class="pre">--hstore_tags</span></code> option to specify the name of the column to obtain tags from. Note that if multiple tables are specified (e.g. multiple tables with new or modified features) they all must contain hstore columns with the same name. In the case where tag names are duplicated between the hstore and the database table columns, column key values will take precedence over values in the hstore.</p>
</section>
<section id="compressed-changefiles">
<h3>Compressed changefiles<a class="headerlink" href="#compressed-changefiles" title="Permalink to this headline">¶</a></h3>
<p>The OSMChange format is an XML-based structured format that specifies changes to be made to an OSM Planet file. Most readers of this format support compression, so we provide a <code class="docutils literal notranslate"><span class="pre">--compress</span></code> flag that enables changegen to output gzipped changefiles.</p>
</section>
</section>
</section>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="postgis.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">PostGIS Tips + Considerations</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
            |
            <a class="muted-link" href="_sources/quickstart.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quickstart / Usage Guide</a><ul>
<li><a class="reference internal" href="#setup-installation">Setup + Installation</a><ul>
<li><a class="reference internal" href="#database-setup-access">Database Setup + Access</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-changegen-cli">Using the Changegen CLI</a><ul>
<li><a class="reference internal" href="#adding-new-features-to-osm-file">Adding new features to OSM file</a></li>
<li><a class="reference internal" href="#modifying-existing-features-in-the-osm-file">Modifying existing features in the OSM file</a></li>
<li><a class="reference internal" href="#removing-existing-features-in-the-osm-file">Removing existing features in the OSM file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-features">Other Features</a><ul>
<li><a class="reference internal" href="#maintaining-all-tags-with-hstore-columns">Maintaining all Tags with Hstore columns</a></li>
<li><a class="reference internal" href="#compressed-changefiles">Compressed changefiles</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>